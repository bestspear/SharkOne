;
; Veil.Test.Kernel.inf
;

;-------------------------------------------------------------------------
; Veil.Test.Kernel.INF -- Device Driver
;
; Copyright (c) 2019, Microsoft.Com LLC.  All rights reserved.
;------------------------------------------------------------------------

; INF MSDN:
;     https://docs.microsoft.com/en-us/windows-hardware/drivers/install/roadmap-for-device-and-driver-installation--windows-vista-and-later-
;
; Class And ClassGuid MSDN:
;     https://docs.microsoft.com/en-us/windows-hardware/drivers/ifs/file-system-filter-driver-classes-and-class-guids
;     https://docs.microsoft.com/en-us/windows-hardware/drivers/install/system-defined-device-setup-classes-available-to-vendors
[Version]
Signature   = "$WINDOWS NT$"
Class       = System
ClassGuid   ={4d36e97d-e325-11ce-bfc1-08002be10318}
Provider    = %ManufacturerName%
CatalogFile = %DriverName%.cat
DriverVer   = 
PnpLockdown = 1


;-------------------------------------------------------------------------
; Installation Section
;-------------------------------------------------------------------------


; DestinationDirs MSDN
;     https://docs.microsoft.com/en-us/windows-hardware/drivers/install/inf-destinationdirs-section
[DestinationDirs]
DefaultDestDir  = 12


; SourceDisksNames MSDN
;     https://docs.microsoft.com/en-us/windows-hardware/drivers/install/inf-sourcedisksnames-section
[SourceDisksNames]
1 = %DiskName%,,,""


; SourceDisksFiles MSDN
;     https://docs.microsoft.com/en-us/windows-hardware/drivers/install/inf-sourcedisksfiles-section
; Each filename entry must specify the exact name of a file on the source disk. 
;     You cannot use a %strkey% token to specify the file name.
[SourceDisksFiles]
Veil.Test.Kernel.sys    = 1,,


; Copyfiles MSDN:
;     https://docs.microsoft.com/en-us/windows-hardware/drivers/install/inf-copyfiles-directive
[Install.Copyfiles]
%DriverName%.sys,%DriverName%.sys,,0x00004022 ; COPYFLG_NOSKIP | COPYFLG_NO_VERSION_DIALOG | COPYFLG_IN_USE_RENAME


; Delfiles MSDN:
;     https://docs.microsoft.com/en-us/windows-hardware/drivers/install/inf-delfiles-directive
[Install.Delfiles]
%DriverName%.sys


;-------------------------------------------------------------------------
; Service installation support
;-------------------------------------------------------------------------


[DefaultInstall]
CopyFiles       =Install.Copyfiles


; LegacyUninstall MSDN:
;     https://docs.microsoft.com/en-us/windows-hardware/drivers/develop/creating-a-primitive-driver
[DefaultUninstall]
LegacyUninstall = 1
DelFiles        = Install.Delfiles


[DefaultInstall.Services]
; You may want to add the SPSVCINST_STARTSERVICE flag, like this:
;     AddService=%ServiceName%,0x800,InstallService.Arch ; SPSVCINST_STARTSERVICE
; AddService MSDN
; SPSVCINST_STARTSERVICE=0x800
;     https://docs.microsoft.com/en-us/windows-hardware/drivers/install/inf-addservice-directive
AddService      = %ServiceName%,0x000,InstallService

; SPSVCINST_STOPSERVICE=0x200
; DelService MSDN:
;     https://docs.microsoft.com/en-us/windows-hardware/drivers/install/inf-delservice-directive
[DefaultUninstall.Services]
DelService      = %ServiceName%,0x200


[InstallService]
DisplayName    = %ServiceName%
Description    = %ServiceDesc%
ServiceBinary  = %12%\%DriverName%.sys
ServiceType    = 1                  ; SERVICE_KERNEL_DRIVER
StartType      = 3                  ; 0 = SERVICE_BOOT_START
                                    ; 1 = SERVICE_SYSTEM_START
                                    ; 2 = SERVICE_AUTO_START
                                    ; 3 = SERVICE_DEMAND_START
                                    ; 4 = SERVICE_DISABLED
ErrorControl   = 1                  ; SERVICE_ERROR_NORMAL

;-------------------------------------------------------------------------
; Strings section
;-------------------------------------------------------------------------


[Strings]
ManufacturerName        = "Kaku"
DriverName              = "Veil.Test.Kernel"
ServiceName             = "Veil.Test"
ServiceDesc             = "Veil.Test Driver"
DiskName                = "Veil.Test.Kernel Source Disk"
